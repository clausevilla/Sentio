<!-- Author: Lian Shi -->
 <!-- Disclaimer: This consent page content has been drafted with the assistance of LLM.
  Manual review and adjustments were made to tailor the content to this specific student project to ensure compliance with GDPR principles. -->
{% extends 'base.html' %}
{% load static %}


{% block title %}Data Processing Consent - Sentio{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'accounts/css/consent.css' %}">
{% endblock %}



{% block content %}
<div class="consent-container">
    <div class="consent-header">
        <h2>Data Processing Consent</h2>
        <p>Your privacy is important to us</p>
    </div>

    <!-- Alert messages -->
    {% if messages %}
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">
        {{ message }}
    </div>
    {% endfor %}
    {% endif %}

    <!-- Re-consent notice (shown when user's consent was previously revoked) -->
    {% if user.consent and not user.consent.has_consented %}
    <div class="reconsent-notice">
        <h3><i class="fas fa-sync-alt"></i> Consent Required</h3>
        <p>Your previous consent was revoked (possibly after deleting your data).
           Please provide your consent again to continue.</p>
    </div>
    {% endif %}

    <div class="consent-content">
        <h2>Before you continue, please understand:</h2>
        <ul>
            <li><strong>Sensitive Data:</strong> This application analyzes text to assess mental health states. The text you submit and the analysis results are considered sensitive health information under GDPR.</li>
            <li><strong>What We Collect:</strong> We will store the text you submit, the AI-generated mental health state predictions, and timestamps of your analyses.</li>
            <li><strong>How We Use It:</strong> Your data is used solely to provide mental health analysis services and show you your history over time. We do not share your data with third parties.</li>
            <li><strong>Your Control:</strong> You can view, export, or permanently delete all your data at any time through your profile settings.</li>
            <li><strong>Security:</strong> We implement appropriate technical and organizational measures to protect your data from unauthorized access, alteration, or deletion.</li>
        </ul>
    </div>

    <div class="consent-warning">
        <i class="fas fa-exclamation-triangle"></i>
        <p><strong>Important Disclaimer:</strong> This tool is for educational demonstration only. The mental health predictions are generated by a machine learning model and should not be used as a substitute for professional mental health assessment or treatment. If you are experiencing mental health concerns, please consult qualified healthcare professionals. </p>
    </div>

    <form method="post" action="{% url 'accounts:consent' %}" id="consentForm">
        {% csrf_token %}

        <div class="consent-checkbox-container" id="consentCheckboxContainer">
            <label>
                <input type="checkbox" name="consent" id="consentCheckbox" required>
                <span>I am at least 18 years old. I understand and consent to the collection and processing of my text submissions and mental health analysis data as described above. I have read and agree to the <a href="{% url 'accounts:privacy_policy' %}" target="_blank">Privacy Policy</a>.</span>
            </label>
        </div>

        <div class="consent-actions">
            <a href="{% url 'accounts:logout' %}" class="btn btn-secondary">
                <i class="fas fa-times"></i> I Do Not Consent
            </a>
            <button type="submit" class="btn btn-primary" id="consentButton" disabled>
                <i class="fas fa-check"></i> I Consent - Continue
            </button>
        </div>
    </form>


</div>



<script src="{% static 'accounts/js/consent.js' %}"></script>
{% endblock %}